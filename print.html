<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Gobba Programming Language Handbook</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded "><a href="install.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="expanded "><a href="basics.html"><strong aria-hidden="true">2.</strong> The Basics</a></li><li class="expanded "><a href="ocaml.html"><strong aria-hidden="true">3.</strong> Calling Gobba from OCaml</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">The Gobba Programming Language Handbook</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#installation" id="installation">Installation</a></h1>
<p>To install, you need to have <code>opam</code> (OCaml's package manager with a version greater than 2.0) and a recent OCaml
distribution installed on your system.
You can install <strong>gobba</strong> by running</p>
<pre><code class="language-bash">opam install gobba
</code></pre>
<h3><a class="header" href="#manual-installation" id="manual-installation">Manual installation</a></h3>
<pre><code class="language-bash"># clone the repository
git clone https://github.com/0x0f0f0f/gobba
# cd into it
cd gobba
# install dependencies
opam install dune menhir ANSITerminal cmdliner alcotest bisect_ppx ocamline
# compile
make
# test
make test
# run
make run
# rlwrap is suggested
rlwrap make run
# you can install gobba with
make install
# run again
rlwrap gobba
</code></pre>
<h2><a class="header" href="#usage" id="usage">Usage</a></h2>
<p>The executable name is <code>gobba</code>. If a file is specified as the first command
line argument, then it will be ran as a program. If you are running a program you may want to use the flag <code>-p</code> to print the results of the expressions that are evaluated. Otherwise, if a program is not specified a REPL session will
be opened.</p>
<p>Keep in mind that <strong>gobba</strong> is purely functional and values
are immutable by default!</p>
<h3><a class="header" href="#command-line-options" id="command-line-options">Command Line Options</a></h3>
<ul>
<li>
<p><code>--help[=FMT] (default=auto)</code>:
Show this help in format FMT. The value FMT must be one of <code>auto</code>,
<code>pager</code>, <code>groff</code> or <code>plain</code>. With <code>auto', the format is </code>pager<code>or
   </code>plain' whenever the TERM env var is `dumb' or undefined.</p>
</li>
<li>
<p><code>--internals</code>:
To print or not the language's internal stack traces</p>
</li>
<li>
<p><code>-m MAXSTACKDEPTH, --maxstackdepth=MAXSTACKDEPTH (absent=10)</code>:
The maximum level of nested expressions to print in a stack trace.</p>
</li>
<li>
<p><code>-p, --printexprs</code>:
If set, print the result of expressions when evaluating a program
from file</p>
</li>
<li>
<p><code>-v VERBOSITY, --verbose=VERBOSITY (absent=0)</code>:
If 1, Print AST to stderr after expressions are entered in the
REPL. If 2, also print reduction steps</p>
</li>
<li>
<p><code>--version</code>
Show version information.</p>
</li>
</ul>
<h1><a class="header" href="#the-gobba-programming-language-basics" id="the-gobba-programming-language-basics">The Gobba Programming Language Basics</a></h1>
<h3><a class="header" href="#arithmetics-with-full-scheme-like-numeric-tower" id="arithmetics-with-full-scheme-like-numeric-tower">Arithmetics with full scheme-like numeric tower</a></h3>
<p>Integer division returns an integer if the modulo is 0, and returns a float
otherwise. Floating point numbers decimal part can be omitted if it is 0.
Floating point numbers can use the power syntax using <code>e</code>.</p>
<pre><code class="language-ocaml">1 + 2 + 3 * (4 - 1) ;
1 + 4.0 - 1. / 2.315 ;
1.2e-3 ;
true &amp;&amp; false || (1 &lt; 2) &amp;&amp; (1 = 1) ;
</code></pre>
<h3><a class="header" href="#complex-numbers" id="complex-numbers">Complex numbers</a></h3>
<p>The <code>:+</code> and operators are used to create complex values, the number
on the left will be the real part and the one on the right will be allocated as the imaginary part.</p>
<pre><code class="language-ocaml">12.1 :+ 1.23;
0 :+ 1.12;
</code></pre>
<h3><a class="header" href="#declarations" id="declarations">Declarations</a></h3>
<p>Local declaration statements are purely functional and straightforward:</p>
<pre><code class="language-ocaml">let x = 4 and y = 1 in x + y
</code></pre>
<p>Global declaration statements create new, purely functional environments in both
programs and the REPL. Omitting <code>in</code> is syntax-sugar, subsequent blocks will
be evaluated in the resulting new environment.</p>
<pre><code class="language-ocaml">let a = 2 ;
x + 3 ;
</code></pre>
<h3><a class="header" href="#toplevel-directives" id="toplevel-directives">Toplevel Directives</a></h3>
<p>Toplevel directives can be used in both files and the REPL. Like in OCaml, they
start with a <code>#</code> symbol. Note that toplevel directives are not expressions and
they can only be used in a file (or REPL) top level, and cannot be used inside expressions.</p>
<p><code>#include</code> loads a file at a position relative to the current directory (if in
the REPL) or the directory containing the current running file (in file mode).
The declarations in the included file will be included in the current toplevel environment:</p>
<pre><code class="language-ocaml">#include &quot;examples/fibonacci.mini&quot;
</code></pre>
<p><code>#module</code> loads a file like <code>#include</code> but the declarations in the included file
will be wrapped in a dictionary, that acts as a module:</p>
<pre><code class="language-ocaml">#module &quot;examples/fibonacci.mini&quot;
(* Declarations will be available in module *) Fibonacci
</code></pre>
<p><code>#verbosity n</code> sets verbosity level to <code>n</code>. There are &quot;unit&quot; directives:
<code>#dumpenv ()</code> and <code>#dumppurityenv ()</code> dump the current environments. <code>#pure ()</code>,
<code>#impure ()</code> and <code>#uncertain ()</code> set the globally allowed purity level.</p>
<h3><a class="header" href="#character-literals" id="character-literals">Character literals.</a></h3>
<p>The same as all the other languages: Single characters enclosed in <code>'</code> are character literals,
such as <code>'a'</code> or <code>'\n'</code>. UTF-8 support is planned for a future release.</p>
<h3><a class="header" href="#strings-and-lists" id="strings-and-lists">Strings and Lists</a></h3>
<p>Here is how to concatenate strings</p>
<pre><code class="language-haskell">&quot;hello &quot; ++ &quot;world&quot;
(* It is the same as *)
String:concat &quot;hello &quot; &quot;world&quot;
</code></pre>
<p>To convert any value to a string you can use the <code>show</code> primitive.</p>
<p><code>::</code> means is the classic <code>cons</code> operator, while <code>++</code> is used for list and string concatenation</p>
<pre><code class="language-haskell">1 :: [2] ++ [3]
</code></pre>
<p>To access nth value of a list, the <code>@</code> (at) operator is used. Lists are indexed from 0.</p>
<pre><code class="language-ocaml">[1, 2, 3, 4] @ 0 (* =&gt; 1 *)
[1, 2, 3, 4] @ 2 (* =&gt; 3 *)
</code></pre>
<p>In gobba, the classic functional programming functions and morphisms on lists
are defined in the <code>List</code> module:</p>
<pre><code class="language-ocaml">List:head [1, 2, 3, 4] ;
List:tail [1, 2, 3, 4] ;
List:map (fun x -&gt; x + 1) [1, 2, 3, 4] ;
List:foldl (fun x y -&gt; x - y) 10 [1, 2, 3, 4] ;
List:foldr (fun x y -&gt; x - y) 10 [1, 2, 3, 4] ;
</code></pre>
<h3><a class="header" href="#functions-and-recursion" id="functions-and-recursion">Functions and recursion</a></h3>
<p>For parsing simplicity, only the OCaml anonymous function style of declaring
functions is supported. The keyword <code>fun</code> is interchangeable with <code>lambda</code>.</p>
<pre><code class="language-ocaml">(fun x -&gt; x + 1) 1;
let fib = fun n -&gt; if n &lt; 2 then n else (fib (n - 1)) + fib (n - 2)
</code></pre>
<p>Functions are abstracted into a single parameter chain of functions, and they
can be partially applied:</p>
<pre><code class="language-ocaml">(fun x y z -&gt; x + y + z) = (fun x -&gt; fun y -&gt; fun z -&gt; x + y + z) ;
(* result: true - bool - This is true!! *)

let f = (fun x y z -&gt; x + y + z) in f 1 2 3 ;
(* result: 6 - int - Function application *)

let f = (fun x y z -&gt; x + y + z) in f 1 2 ;
(* result: (fun z -&gt; ... ) - fun - Partial application *)
</code></pre>
<h3><a class="header" href="#dictionaries-and-modules" id="dictionaries-and-modules">Dictionaries and modules.</a></h3>
<p>Dictionary (object) values are similar to Javascript objects. The difference
from javascript is that the keys of an existing dictionary are treated as
symbols, and values can be lazy.</p>
<p>You may have noticed that dictionary fields are syntactically similar to the
assignments in <code>let</code> statements. This is because there is a strict approach
towards simplicity in the parsing logic and language syntax. A difference from
<code>let</code> statements, is that values in dictionaries can only access the
lexical scope <strong>outside</strong> of the dictionary.</p>
<pre><code class="language-ocaml">let n = {hola = 1, lazy mondo = 2, somefunc = fun x -&gt; x + 1 } ;
let m = Dict:insert &quot;newkey&quot; 123 n ;
m = {newkey = 123, hola = 1, mondo = 2, somefunc = fun x -&gt; x + 1 } (* =&gt; true *)
Dict:haskey &quot;newkey&quot; m (* =&gt; true *)
(* =&gt; {newkey = 124, hola = 2, mondo = 3} *)
</code></pre>
<p>An element of a dictionary can be accessed using the <code>:</code> infix operator.</p>
<pre><code class="language-ocaml">m:hola (* returns 1 *)
</code></pre>
<p>Some morphisms are defined in the <code>Dict</code> module.</p>
<pre><code class="language-ocaml">Dict:map (fun x -&gt; x + 1) m;
Dict:foldl (fun x y -&gt; x + y) 0 m;
Dict:foldr (fun x y -&gt; x - y) 10 m;
</code></pre>
<h3><a class="header" href="#primitives-and-printing" id="primitives-and-printing">Primitives and printing</a></h3>
<p>The impure primitives <code>IO:print</code> and <code>IO:print_endline</code> automatically call <code>show</code> on a
value. The difference between them is that <code>IO:print_endline</code> automatically adds a
newline at the end of the line.</p>
<h3><a class="header" href="#haskell-like-dollar-syntax" id="haskell-like-dollar-syntax">Haskell-like dollar syntax</a></h3>
<p>Too many parens?</p>
<pre><code class="language-ocaml">f (g (h (i 1 2 3)))
</code></pre>
<p>Is equivalent to</p>
<pre><code class="language-haskell">f $ g $ h $ i 1 2 3
</code></pre>
<h3><a class="header" href="#toggle-between-pure-and-impure-environments-in-code-for-io" id="toggle-between-pure-and-impure-environments-in-code-for-io">Toggle between pure and impure environments in code for I/O</a></h3>
<p>You can choose to enable or disable impure primitives explicitely, inside an
expression by wrapping it into the <code>pure</code> and <code>impure</code> statements. They must be
followed by an expression. An expression contained in an <code>impure</code> statement is a
computation that calls primitives that have side effects, such as direct memory
access or I/O access.</p>
<p>It is good practice to reduce the use of the <code>pure/impure</code> keywords as much as
possible, and to avoid using it inside of function bodies. This means keeping
your code as purely functional as you can.</p>
<pre><code class="language-ocaml">let bad_function = fun x -&gt;
    impure (let mystring =
        &quot;I am a bad impure function! Also: &quot; ++ x in
        IO:print_endline mystring );

let good_function = fun x -&gt;
    IO:print_endline (&quot;I am a good function! Also: &quot; ++ x) ;

bad_function &quot;hello!&quot; ;
(* The above statement is causing side effects and will error *)

good_function &quot;hello! I should error&quot; ;
(* The above will error, because it is trying to execute
an impure computation in a pure environment
Here's a good way of calling it *)
impure $ good_function &quot;hello!&quot; ;

(* You can specify that you DO NOT want to compute impure
expressions by using the pure statement *)
pure $ good_function &quot;henlo world! I should error&quot; ;
(* The above will error because
it contains an impure computation*)
pure $ bad_function &quot;ciao mondo! I should error&quot; ;
(* The above will error because a pure contest
does not allow nesting an impure contest inside *)
</code></pre>
<p>A good way of structuring your code is keeping <code>pure/impure</code> statements as
external from expressions as you can (towards the top level). By default, the
interpreter is in a <code>uncertain</code> state, it means that it will allow the execution
of <code>impure</code> statements</p>
<h3><a class="header" href="#function-pipes-reverse-composition-and-composition" id="function-pipes-reverse-composition-and-composition">Function pipes (reverse composition) and composition</a></h3>
<p>You can redirect the result of a function to the first argument of another
function using the <code>&gt;=&gt;</code> operator.</p>
<pre><code class="language-ocaml">let sum_and_add_one = (fun x y -&gt; x + y) &gt;=&gt; (fun z -&gt; z + 1) ;
sum_and_add_one 2 3
(* Will output 6, because 2 + 3 is piped into z + 1*)
</code></pre>
<p>Yields the same result as normal composition:</p>
<pre><code class="language-ocaml">let my_sum = (fun x y -&gt; x + y) ;
let add_one = (fun z -&gt; z + 1) ;
(add_one &lt;=&lt; my_sum) 2 3 = add_one (my_sum 2 3) ;
(* The operator &lt;=&lt; means compose *)
(add_one &lt;=&lt; my_sum) = (my_sum &gt;=&gt; add_one) ;
(* This is also true! *)
</code></pre>
<h3><a class="header" href="#sequencing--operator" id="sequencing--operator">Sequencing (&gt;&gt;) operator</a></h3>
<p>TODO</p>
<h1><a class="header" href="#calling-gobba-from-your-ocaml-programs" id="calling-gobba-from-your-ocaml-programs">Calling gobba from your OCaml programs</a></h1>
<p>You may want to use gobba as an embedded language in your OCaml projects. Just
add gobba as a dependency and you can call gobba code from OCaml fairly easily.
Keep in mind that <strong>gobba</strong> is dynamically typed and if you want to do something
with the results of gobba evaluation you will have to extract the values with
the unpacking functions.</p>
<pre><code class="language-ocaml">(* !!! This not code written in gobba, this is OCaml !!! *)
(* Run a gobba string and retrieve the value and resulting state *)
let x, state = Gobba.Repl.run_string &quot;3.14 * (4.0001)&quot; () in
(* The expression is not altering the state, so let's throw it away *)
let _ = state and extracted_value = Gobba.Typecheck.unpack_float x in
print_float extracted_value
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
